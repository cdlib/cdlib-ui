// ***** Slideshow Component ***** //

$slideshow-grid-width1: 19rem;
$slideshow-grid-width2: 50%;

@mixin slideshow-caption-bg {
  background-color: rgba($color-blue, 0.8);

  @supports (backdrop-filter: blur(1px)) {
    background-color: rgba($color-blue, 0.7);
    backdrop-filter: blur(5px);
  }

}

.c-slideshow {
  overflow: hidden;
  grid-template-rows: 1fr auto;

  @supports (display: grid) and (display: contents) {
    display: grid;
  }

  @include screen1 {
    position: relative;
    grid-template-columns: minmax(auto, $slideshow-grid-width1) minmax($slideshow-grid-width2, auto);
  }

  // ***** Set 'no js', 'basic', and 'enhanced' modes; displays a single, random, or all slides ***** //

  // no js mode - show only the first slide; hide controls.
  .c-slideshow__slide {
    display: contents;

    &:not(:first-of-type) {
      display: none;
    }

  }

  .c-slideshow__controls {
    display: none;
  }

  // basic mode - like no js mode, but randomly show a fixed slide. Active when @supports (display: grid) and (display: contents) condition is false, as with IE 11.
  &.basic {

    .c-slideshow__slide {
      display: none;

      &.fixed {
        display: block;
      }

    }

  }

  // enhanced mode - show all slides; set opacity and transitions. Active when @supports (display: grid) and (display: contents) condition is true, as with modern browsers.
  &.enhanced {

    .c-slideshow__slide {
      display: contents;

      figcaption {
        transition: opacity 1s;
        opacity: 0;

        @include screen1 {
          margin-bottom: 0;
        }

        + .c-slideshow__slide-image {
          transition: opacity 1s;
          opacity: 0;
        }

        &.active {
          opacity: 1;
          z-index: 2;

          + .c-slideshow__slide-image {
            opacity: 1;
          }

        }

      }

    }

    .c-slideshow__controls {
      display: flex;
      z-index: 1;
    }

  }

}

.c-slideshow__controls {
  align-items: center;
  justify-content: space-evenly;
  border-top: 1px solid $color-white;
  background-color: $color-blue;
  grid-row: 2;
  grid-column: 1;

  @include screen1 {
    @include slideshow-caption-bg;
    margin-bottom: $space2;
    margin-left: $space2;
  }

  button {
    width: 2em;
    height: 2em;
    padding: 0;
    border: none;
    background-color: transparent;
    background-repeat: no-repeat;
    background-position: center;
    background-size: 0.8em;
    color: $color-gold;
    cursor: pointer;

    &:focus,
    &:hover {
      color: $color-white;
    }

    span {
      @include u-hide;
    }

  }

}

.c-slideshow__play {
  background-image: url('play.svg' param(--color #{$color-gold}));

  &:focus,
  &:hover {
    background-image: url('play.svg' param(--color #{$color-white}));
  }

}

.c-slideshow__pause {
  background-image: url('pause.svg' param(--color #{$color-gold}));

  &:focus,
  &:hover {
    background-image: url('pause.svg' param(--color #{$color-white}));
  }

}

.c-slideshow__slide {

  figcaption {
    display: flex;
    flex-direction: column;
    padding: $space2;
    background-color: $color-blue;
    color: $color-white;
    font-style: normal;
    z-index: 1;
    grid-row: 1;
    grid-column: 1;

    @include screen1 {
      @include slideshow-caption-bg;
      position: relative;
      width: calc(#{$slideshow-grid-width2} - #{$space2});
      margin-top: $space2;
      margin-bottom: $space2;
      margin-left: $space2;

      @supports (display: grid) and (display: contents) {
        position: static;
        width: auto;
      }

    }

    @include screen2 {
      position: absolute;
      top: 0;
      bottom: 0;
      width: calc(#{$slideshow-grid-width1} - #{$space2});

      @supports (display: grid) and (display: contents) {
        position: static;
        width: auto;
      }

    }

    // ***** Slide Text ***** //

    // heading:
    @include u-headings {
      margin-bottom: $space2;
      color: inherit;
      font-size: 2rem;
      font-weight: normal;
    }

    // body copy:
    p {
      font-size: 1.3rem;
    }

    // any linked text:
    a {
      color: $color-gold;
    }

    // 'read more' link at bottom:
    > a {
      margin-top: auto;
    }

    // credits:
    small {
      display: none;

      @include screen1 {
        display: block;
        margin-top: 1em;
        font-size: 0.9em;

        @supports (display: grid) and (display: contents) {
          position: absolute;
          right: 0;
          bottom: 0;
          max-width: calc(#{$slideshow-grid-width2} - #{$space2});
          padding: $space2;
          background-color: rgba($color-black, 0.4);
          font-size: 1em;
          text-align: right;

          @supports (backdrop-filter: blur(1px)) {
            background-color: rgba($color-black, 0.2);
            backdrop-filter: blur(5px);
          }

        }

      }

    }

  }

}

.c-slideshow__slide-image {

  img {
    display: none;
  }

  @include screen1 {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    background-color: $color-gray;
    grid-row: 1 / 3;
    grid-column: 1 / 3;

    @supports (display: grid) and (display: contents) {
      position: relative;
    }

    img {
      display: block;
      width: 100%;
      object-fit: cover;

      @supports (object-fit: cover) {
        height: 100%;
      }

      @supports (display: grid) and (display: contents) {
        position: absolute;
      }

    }

  }

}
